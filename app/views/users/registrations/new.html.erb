<h2><%= t('sign_up.title') %></h2>


<%= form_with model: @user, url: registration_path(resource_name), local: true do |f| %>
  <%= render "users/shared/error_messages", resource: resource %>

  <div class="field">
    <%= f.label :image %><br/>
    <%= f.file_field :image, value: @user.default_image %>
    <% if resource.image? %>
      <%= image_tag resource.image.url, class: 'icon_image', id: 'preview-image' %>
    <% else %>
      <%= image_tag 'default_image.png', class: 'icon_image', alt: 'Default Image', id: 'preview-image' %>
    <% end %>
  </div>

  <div class="field">
    <%= f.label :name %> <br />
    <%= f.text_field :name %>
  </div>

  <div class="field">
    <%= f.label :email %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: "email" %>
  </div>

  <div class="field">
    <%= f.label :password %>
    <% if @minimum_password_length %>
    <em>(<%= @minimum_password_length %> 文字以上で入力してください)</em>
    <% end %><br />
    <%= f.password_field :password, autocomplete: "new-password" %>
  </div>

  <div class="field">
    <%= f.label :password_confirmation %><br />
    <%= f.password_field :password_confirmation, autocomplete: "new-password" %>
  </div>

  <div class="field">
    <%= f.label :prefecture_id %><br />
    <%= f.collection_select :prefecture_id, @prefectures, :id, :name, prompt: '選択してください' %>
  </div>

  <div class="field">
    <%= f.label :second_prefecture_id %><br />
    <%= f.collection_select :second_prefecture_id, @prefectures, :id, :name, prompt: '必要に応じて選択してください' %>
  </div>

  <div class="field">
    <%= f.label :constitution_id %><br />
    <%= f.collection_select :constitution_id, @constitutions, :id, :name, prompt: '選択してください' %>
  </div>
  
  <div class="actions">
    <%= f.submit  t('actions.sign_up')  %>
  </div>
<% end %>

<% if flash[:notice] %>
  <div class="alert alert-success">
    <%= flash[:notice] %>
  </div>
<% elsif flash[:alert] %>
  <div class="alert alert-danger">
    <%= flash[:alert] %>
  </div>
<% end %>

<%= render "users/shared/links" %>